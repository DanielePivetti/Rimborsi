{# File: modifica_documento.html #}
{% extends 'base.html' %}
{% block title %}Modifica Documento{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        {# La rotta passa l'oggetto 'documento', quindi il form sarà in modalità "modifica" #}
        {% include 'partials/_form_documento.html' %}
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() if super }} {# Mantiene gli script del template base, se presenti #}
    <script src="{{ url_for('static', filename='js/camera.js') }}"></script>

    {# Lo script per la logica del form rimane qui, nel template principale,
       perché deve poter controllare gli elementi del form. #}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tipoDocumentoSelect = document.getElementById('tipo_documento');
            const importoContainer = document.getElementById('importo-container');
            const importoInput = document.getElementById('importo_documento');
            const tipiSenzaImporto = ['C', 'D'];

            function toggleImportoField() {
                if (!tipoDocumentoSelect || !importoContainer || !importoInput) {
                    console.error("Elementi del form non trovati. Controlla gli id.");
                    return;
                }
                const valoreSelezionato = tipoDocumentoSelect.value;
                if (tipiSenzaImporto.includes(valoreSelezionato)) {
                    importoContainer.style.display = 'none';
                    importoInput.value = '0.00'; // imposta sempre 0.00
                } else {
                    importoContainer.style.display = 'block';
                    importoInput.value = '';
                }
            }

            tipoDocumentoSelect.addEventListener('change', toggleImportoField);
            toggleImportoField();
        });
    </script>
{% endblock %}